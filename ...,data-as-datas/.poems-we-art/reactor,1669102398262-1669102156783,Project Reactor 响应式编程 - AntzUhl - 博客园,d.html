<!DOCTYPE html> <html lang=zh-cn style=--olcb-folder-code-block-max-height:80vh><!--
 Page saved with SingleFile 
 url: https://www.cnblogs.com/LexMoon/p/reactor.html 
 saved date: Tue Nov 22 2022 15:33:18 GMT+0800 (中国标准时间)
--><meta charset=utf-8>
<meta name=viewport content="width=device-width, initial-scale=1.0">
<meta name=referrer content=origin-when-cross-origin>
<meta name=description content="一. 什么是响应式编程? 在计算中，响应式编程或反应式编程是一种面向数据流和变化传播的声明式编程范式。这意味着可以在编程语言中很方便地表达静态或动态的数据流，而相关的计算模型会自动将变化的值通过数据流">
<meta property=og:description content="一. 什么是响应式编程? 在计算中，响应式编程或反应式编程是一种面向数据流和变化传播的声明式编程范式。这意味着可以在编程语言中很方便地表达静态或动态的数据流，而相关的计算模型会自动将变化的值通过数据流">
<meta http-equiv=Cache-Control content=no-transform>
<meta http-equiv=Cache-Control content=no-siteapp>
<meta http-equiv=X-UA-Compatible content="IE=edge">
<title>Project Reactor 响应式编程 - AntzUhl - 博客园</title>
<style>:root{--sf-img-0: /* original URL: https://www.cnblogs.com/images/toc.svg */ url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNCAyNCI+PHBhdGggZD0iTTAgMGgyNHYyNEgwVjB6IiBmaWxsPSJub25lIi8+PHBhdGggZD0iTTQgMTAuNWMtLjgzIDAtMS41LjY3LTEuNSAxLjVzLjY3IDEuNSAxLjUgMS41IDEuNS0uNjcgMS41LTEuNS0uNjctMS41LTEuNS0xLjV6bTAtNmMtLjgzIDAtMS41LjY3LTEuNSAxLjVTMy4xNyA3LjUgNCA3LjUgNS41IDYuODMgNS41IDYgNC44MyA0LjUgNCA0LjV6bTAgMTJjLS44MyAwLTEuNS42OC0xLjUgMS41cy42OCAxLjUgMS41IDEuNSAxLjUtLjY4IDEuNS0xLjUtLjY3LTEuNS0xLjUtMS41ek04IDE5aDEyYy41NSAwIDEtLjQ1IDEtMXMtLjQ1LTEtMS0xSDhjLS41NSAwLTEgLjQ1LTEgMXMuNDUgMSAxIDF6bTAtNmgxMmMuNTUgMCAxLS40NSAxLTFzLS40NS0xLTEtMUg4Yy0uNTUgMC0xIC40NS0xIDFzLjQ1IDEgMSAxek03IDZjMCAuNTUuNDUgMSAxIDFoMTJjLjU1IDAgMS0uNDUgMS0xcy0uNDUtMS0xLTFIOGMtLjU1IDAtMSAuNDUtMSAxeiIvPjwvc3ZnPg==")}#home :not(.cnblogs_code):not(.cnblogs_Highlighter)>pre:not([class*="language-"]):not([highlighted]):not(.hljs):not([class*="brush:"]),:not(.cnblogs_code):not(.cnblogs_Highlighter)>pre:not([class*="language-"]):not([highlighted]):not(.hljs):not([class*="brush:"]){background:#fff;padding:14.4px;border:1px solid #ddd;border-radius:0px;border-color:transparent;color:#393a34;font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace;font-size:14.4px}#blog_post_info_block{margin-top:20px}#BlogPostCategory{margin-bottom:10px}.cnblogs-markdown :not(pre,div,td)>code,.blogpost-body :not(pre,div,td)>code{font-family:"Courier New",sans-serif;font-size:12px;padding:0 5px;line-height:1.8;margin:0 3px;display:inline-block;overflow-x:auto;vertical-align:middle;border-radius:3px;background-color:#f6f6f6;color:#e83e8c}pre,pre code,pre code *{transition-duration:.2s;transition-property:background-color,border-color,border-radius,padding-top,padding-bottom,margin-top,margin-bottom,color,opacity}pre code{transition-property:color,opacity,padding-top,padding-bottom,margin-top,margin-bottom,height}.cnblogs-markdown pre code{display:block;line-height:1.5;margin:0;white-space:pre-wrap}pre{margin-top:0;margin-bottom:0}#post_next_prev{line-height:1.8;font-size:12px}#post_next_prev a.p_n_p_prefix:link{text-decoration:none}#post_next_prev a.p_n_p_prefix:hover{text-decoration:underline}blockquote{padding-left:10px;padding-right:10px;padding-top:5px;padding-bottom:5px;margin-top:10px;margin-bottom:10px}.blogpost-body blockquote{border-left:3px solid #e2dfdf;border-right:0;border-top:0;border-bottom:0}#cnblogs_post_body{margin-bottom:20px}#cnblogs_post_body ul{margin-left:30px;padding-left:0}#cnblogs_post_body ol{padding-left:40px}#cnblogs_post_body ol li{list-style-type:decimal}#cnblogs_post_body ul li{list-style-type:disc}#cnblogs_post_body ul ul li{list-style-type:circle}#cnblogs_post_body{word-break:break-word}#cnblogs_post_body>pre,#cnblogs_post_body p{margin:10px auto}#cnblogs_post_body p{text-indent:0}#cnblogs_post_body h1{font-size:28px;font-weight:bold;line-height:1.5;margin:10px 0}#cnblogs_post_body h2{font-size:21px;font-weight:bold;line-height:1.5;margin:10px 0}#cnblogs_post_body h4{font-size:14px;font-weight:bold;margin:10px 0}.vertical-middle>*{vertical-align:middle}@keyframes fadeIn{0%{opacity:0}100%{opacity:var(--cnb-code-toolbar-initial-opacity)}}pre:fullscreen,pre:fullscreen code{box-sizing:border-box;border-radius:0;height:100vh;width:100vw}:root{--highlighted-line-bg:#d1e3c9;--highlighted-line-bg-dark:#264b33}pre.prismjs-lines-highlighted{--spacing-right:1em}pre.prismjs-lines-highlighted ::after,pre.prismjs-lines-highlighted ::before{box-sizing:border-box}pre.prismjs-lines-highlighted[class*="language-"]{padding-left:var(--spacing-left);padding-right:var(--spacing-right)}pre.prismjs-lines-highlighted[class*="language-"]:not(.line-numbers){--spacing-left:1em}@-webkit-keyframes collapse{from{max-height:80vh;max-height:80vh;max-height:var(--olcb-folder-code-block-scroll-height,80vh)}to{max-height:80vh;max-height:80vh;max-height:var(--olcb-folder-code-block-max-height,80vh)}}@keyframes collapse{from{max-height:80vh;max-height:80vh;max-height:var(--olcb-folder-code-block-scroll-height,80vh)}to{max-height:80vh;max-height:80vh;max-height:var(--olcb-folder-code-block-max-height,80vh)}}@-webkit-keyframes expand{from{max-height:80vh;max-height:80vh;max-height:var(--olcb-folder-code-block-max-height,80vh);overflow-y:hidden}to{max-height:"";max-height:"";max-height:var(--olcb-folder-code-block-scroll-height,"");overflow-y:hidden}}@keyframes expand{from{max-height:80vh;max-height:80vh;max-height:var(--olcb-folder-code-block-max-height,80vh);overflow-y:hidden}to{max-height:"";max-height:"";max-height:var(--olcb-folder-code-block-scroll-height,"");overflow-y:hidden}}@keyframes modal-open{0%{height:0;opacity:0}95%{height:505px}100%{height:auto;opacity:1}}:root{--cnblogs-toc-bg-color:rgba(245,245,245,.98);--cnblogs-toc-highlight-color:rgba(255,255,255,.9);--cnblogs-toc-color:#000}*:hover>.cnblogs-toc-button:not(.disabled){display:inline}body{min-height:100vh}.cnblogs-toc-button:active,.cnblogs-toc-button.active{display:inline;opacity:100%}.cnblogs-toc-button{font-size:inherit;color:inherit;opacity:50%;outline:0;-moz-appearance:none;-webkit-appearance:none;appearance:none;background:transparent;border:0;cursor:pointer;-moz-user-select:none;-ms-user-select:none;-webkit-user-select:none;user-select:none;padding:0;margin-left:.5rem;text-transform:none;text-decoration:none;vertical-align:middle}.cnblogs-toc-button{display:none}.cnblogs-toc-button:hover{opacity:80%}.cnblogs-toc-button::before{content:"";background-color:currentColor;-webkit-mask-image:var(--sf-img-0);mask-image:var(--sf-img-0);width:1em;height:1em;display:block;margin:auto;max-width:100%}@keyframes wb-fade-in{0%{opacity:0}to{opacity:.85}}/*!
 * ui-dialog.css
 * Date: 2014-07-03
 * https://github.com/aui/artDialog
 * (c) 2009-2014 TangBin, http://www.planeArt.cn
 *
 * This is licensed under the GNU LGPL, version 2.1 or later.
 * For details, see: http://www.gnu.org/licenses/lgpl-2.1.html
 */@-webkit-keyframes ui-dialog-loading{0%{-webkit-transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg)}}@keyframes ui-dialog-loading{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}body{font-family:"PingFang SC","Microsoft YaHei","Helvetica Neue","Helvetica","Arial",sans-serif;background-image:/* original URL: https://www.cnblogs.com/skins/bluesky/images/bg.gif */url(data:image/gif;base64,R0lGODdhRwBHAJEAAAAAAO7u7vLy8v///yH5BAQKAAAAIf8LSUNDUkdCRzEwMTL/AAAMSExpbm8CEAAAbW50clJHQiBYWVogB84AAgAJAAYAMQAAYWNzcE1TRlQAAAAASUVDIHNSR0IAAAAAAAAAAAAAAAAAAPbWAAEAAAAA0y1IUCAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAARY3BydAAAAVAAAAAzZGVzYwAAAYQAAABsd3RwdAAAAfAAAAAUYmtwdAAAAgQAAAAUclhZWgAAAhgAAAAUZ1hZWgAAAiwAAAAUYlhZWgAAAkAAAAAUZG1uZAAAAlQAAABwZG1kZAAAAsQAAACIdnVlZAAAA0wAAACGdmll/3cAAAPUAAAAJGx1bWkAAAP4AAAAFG1lYXMAAAQMAAAAJHRlY2gAAAQwAAAADHJUUkMAAAQ8AAAIDGdUUkMAAAQ8AAAIDGJUUkMAAAQ8AAAIDHRleHQAAAAAQ29weXJpZ2h0IChjKSAxOTk4IEhld2xldHQtUGFja2FyZCBDb21wYW55AABkZXNjAAAAAAAAABJzUkdCIElFQzYxOTY2LTIuMQAAAAAAAAAAAAAAEnNSR0IgSUVDNjE5NjYtMi4xAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABYWVogAAAAAAAA81EAAf8AAAABFsxYWVogAAAAAAAAAAAAAAAAAAAAAFhZWiAAAAAAAABvogAAOPUAAAOQWFlaIAAAAAAAAGKZAAC3hQAAGNpYWVogAAAAAAAAJKAAAA+EAAC2z2Rlc2MAAAAAAAAAFklFQyBodHRwOi8vd3d3LmllYy5jaAAAAAAAAAAAAAAAFklFQyBodHRwOi8vd3d3LmllYy5jaAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABkZXNjAAAAAAAAAC5JRUMgNjE5NjYtMi4xIERlZmF1bHQgUkdCIGNvbG91ciBzcGFjZSAtIHNSR0L/AAAAAAAAAAAAAAAuSUVDIDYxOTY2LTIuMSBEZWZhdWx0IFJHQiBjb2xvdXIgc3BhY2UgLSBzUkdCAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGRlc2MAAAAAAAAALFJlZmVyZW5jZSBWaWV3aW5nIENvbmRpdGlvbiBpbiBJRUM2MTk2Ni0yLjEAAAAAAAAAAAAAACxSZWZlcmVuY2UgVmlld2luZyBDb25kaXRpb24gaW4gSUVDNjE5NjYtMi4xAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB2aWV3AAAAAAATpP4AFF8uABDPFAAD7cwABBMLAANcngAAAAFYWVog/wAAAAAATAlWAFAAAABXH+dtZWFzAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAACjwAAAAJzaWcgAAAAAENSVCBjdXJ2AAAAAAAABAAAAAAFAAoADwAUABkAHgAjACgALQAyADcAOwBAAEUASgBPAFQAWQBeAGMAaABtAHIAdwB8AIEAhgCLAJAAlQCaAJ8ApACpAK4AsgC3ALwAwQDGAMsA0ADVANsA4ADlAOsA8AD2APsBAQEHAQ0BEwEZAR8BJQErATIBOAE+AUUBTAFSAVkBYAFnAW4BdQF8AYMBiwGSAZoBoQGpAbEBuQHBAckB0QHZAeEB6QHyAfoCAwIMAv8UAh0CJgIvAjgCQQJLAlQCXQJnAnECegKEAo4CmAKiAqwCtgLBAssC1QLgAusC9QMAAwsDFgMhAy0DOANDA08DWgNmA3IDfgOKA5YDogOuA7oDxwPTA+AD7AP5BAYEEwQgBC0EOwRIBFUEYwRxBH4EjASaBKgEtgTEBNME4QTwBP4FDQUcBSsFOgVJBVgFZwV3BYYFlgWmBbUFxQXVBeUF9gYGBhYGJwY3BkgGWQZqBnsGjAadBq8GwAbRBuMG9QcHBxkHKwc9B08HYQd0B4YHmQesB78H0gflB/gICwgfCDIIRghaCG4IggiWCKoIvgjSCOcI+wkQCSUJOglPCWT/CXkJjwmkCboJzwnlCfsKEQonCj0KVApqCoEKmAquCsUK3ArzCwsLIgs5C1ELaQuAC5gLsAvIC+EL+QwSDCoMQwxcDHUMjgynDMAM2QzzDQ0NJg1ADVoNdA2ODakNww3eDfgOEw4uDkkOZA5/DpsOtg7SDu4PCQ8lD0EPXg96D5YPsw/PD+wQCRAmEEMQYRB+EJsQuRDXEPURExExEU8RbRGMEaoRyRHoEgcSJhJFEmQShBKjEsMS4xMDEyMTQxNjE4MTpBPFE+UUBhQnFEkUahSLFK0UzhTwFRIVNBVWFXgVmxW9FeAWAxYmFkkWbBaPFrIW1hb6Fx0XQRdlF4kX/64X0hf3GBsYQBhlGIoYrxjVGPoZIBlFGWsZkRm3Gd0aBBoqGlEadxqeGsUa7BsUGzsbYxuKG7Ib2hwCHCocUhx7HKMczBz1HR4dRx1wHZkdwx3sHhYeQB5qHpQevh7pHxMfPh9pH5Qfvx/qIBUgQSBsIJggxCDwIRwhSCF1IaEhziH7IiciVSKCIq8i3SMKIzgjZiOUI8Ij8CQfJE0kfCSrJNolCSU4JWgllyXHJfcmJyZXJocmtyboJxgnSSd6J6sn3CgNKD8ocSiiKNQpBik4KWspnSnQKgIqNSpoKpsqzysCKzYraSudK9EsBSw5LG4soizXLQwtQS12Last4f8uFi5MLoIuty7uLyQvWi+RL8cv/jA1MGwwpDDbMRIxSjGCMbox8jIqMmMymzLUMw0zRjN/M7gz8TQrNGU0njTYNRM1TTWHNcI1/TY3NnI2rjbpNyQ3YDecN9c4FDhQOIw4yDkFOUI5fzm8Ofk6Njp0OrI67zstO2s7qjvoPCc8ZTykPOM9Ij1hPaE94D4gPmA+oD7gPyE/YT+iP+JAI0BkQKZA50EpQWpBrEHuQjBCckK1QvdDOkN9Q8BEA0RHRIpEzkUSRVVFmkXeRiJGZ0arRvBHNUd7R8BIBUhLSJFI10kdSWNJqUnwSjdKfUrESwxLU0uaS+JMKkxyTLpNAk3/Sk2TTdxOJU5uTrdPAE9JT5NP3VAnUHFQu1EGUVBRm1HmUjFSfFLHUxNTX1OqU/ZUQlSPVNtVKFV1VcJWD1ZcVqlW91dEV5JX4FgvWH1Yy1kaWWlZuFoHWlZaplr1W0VblVvlXDVchlzWXSddeF3JXhpebF69Xw9fYV+zYAVgV2CqYPxhT2GiYfViSWKcYvBjQ2OXY+tkQGSUZOllPWWSZedmPWaSZuhnPWeTZ+loP2iWaOxpQ2maafFqSGqfavdrT2una/9sV2yvbQhtYG25bhJua27Ebx5veG/RcCtwhnDgcTpxlXHwcktypnMBc11zuHQUdHB0zHUodYV14XY+/3abdvh3VnezeBF4bnjMeSp5iXnnekZ6pXsEe2N7wnwhfIF84X1BfaF+AX5ifsJ/I3+Ef+WAR4CogQqBa4HNgjCCkoL0g1eDuoQdhICE44VHhauGDoZyhteHO4efiASIaYjOiTOJmYn+imSKyoswi5aL/IxjjMqNMY2Yjf+OZo7OjzaPnpAGkG6Q1pE/kaiSEZJ6kuOTTZO2lCCUipT0lV+VyZY0lp+XCpd1l+CYTJi4mSSZkJn8mmia1ZtCm6+cHJyJnPedZJ3SnkCerp8dn4uf+qBpoNihR6G2oiailqMGo3aj5qRWpMelOKWpphqmi6b9p26n4KhSqMSpN6mpqv8cqo+rAqt1q+msXKzQrUStuK4trqGvFq+LsACwdbDqsWCx1rJLssKzOLOutCW0nLUTtYq2AbZ5tvC3aLfguFm40blKucK6O7q1uy67p7whvJu9Fb2Pvgq+hL7/v3q/9cBwwOzBZ8Hjwl/C28NYw9TEUcTOxUvFyMZGxsPHQce/yD3IvMk6ybnKOMq3yzbLtsw1zLXNNc21zjbOts83z7jQOdC60TzRvtI/0sHTRNPG1EnUy9VO1dHWVdbY11zX4Nhk2OjZbNnx2nba+9uA3AXcit0Q3ZbeHN6i3ynfr+A24L3hROHM4lPi2+Nj4+vkc+T85YTmDeaW5x/nqegy6LxU6Ubp0Opb6uXrcOv77IbtEe2c7ijutO9A78zwWPDl8XLx//KM8xnzp/Q09ML1UPXe9m32+/eK+Bn4qPk4+cf6V/rn+3f8B/yY/Sn9uv5L/tz/bf//ACwAAAAARwBHAAAC/5SPqcvtr4actMpgM8W6eyt84khepRSeXLmeZerGrAuT7XjLXq33Wf7hiYAeoo8iPB6NmmTRxVQ6lbooCIqlNrVaa2Wq8W64GTDZRsvOzki2TzwxW+AmNwqDH+T3+j7/7xcIOCgYKFdB12c3cLg4l6ai5tboOHZCWbdmh1mp+CKJ48hZmciZmAjZiXYJOiSqqkli2ko26lhK+7Rou4gb+btJKFw4XEx8PAs8Cbv6qRy6ywztHDu9LP3hW+0aja1L3RzOxmunLc696f0tm9uByqoelnqe/Rr/k2asf7yvT+5mzprAM//YBERHj0vBMwfrPSN4Dx+8bQ7TRUQ0b2DFaxkXJzRcp1FhR0vgQrqzN9ITu4cbx6XMRKIAADs=);background-repeat:repeat;background-color:#fffdfa}html{color:#000;overflow-y:scroll;background:#fff}body,h1,h2,h4,p,blockquote,ul,ol,li,pre,button{margin:0;padding:0;list-style-type:none;list-style-image:none}body,button{font:12px/1.5 Tahoma,Arial,Helvetica,sans-serif}h1{font-weight:normal}code{font-family:"Courier New",Courier,monospace}a:link,a:visited{text-decoration:none;color:#39f}a:hover{text-decoration:underline;color:#39f}:focus{outline:0}#home>#main{width:1200px;position:relative;margin:0 auto}#home>#main{margin-top:6px;background-color:#f5f5f5;margin-bottom:0}#mainContent{width:900px;background:#fff;box-shadow:0 0 8px #999;-moz-box-shadow:0 0 8px #999;border-radius:6px;-moz-border-radius:6px;float:left;display:inline-block}.postTitle{font-size:20px;padding-right:64px;padding-left:10px;border-left-width:3px;border-left-style:solid;border-left-color:#2175bc;line-height:1.2}.postTitle a{color:#333}.postTitle a:link,.post-title a:visited,.postTitl2 a:link,.postTitl2 a:visited,.entrylistPosttitle a:link,.entrylistPosttitle a:visited{color:#000}.postTitle a:hover,.postTitl2 a:hover,.entrylistPosttitle a:hover{color:#39f;text-decoration:none}.postBody{clear:both;margin-top:26px}.postBody{font-size:14px;color:#444;line-height:1.8}.postBody ul{list-style:none}.postBody ol{list-style:none;margin-left:20px}.postBody blockquote{margin:0 auto;padding:6px 0 6px 55px;color:#666;background:#fff /* original URL: https://www.cnblogs.com/images/blockquote.gif */url(data:image/gif;base64,R0lGODlhLwAjANUgAOrmzO/s2PDu3PLw4e3q0/b16vTy5vHv3/f27dPQutrXv+zo0czItPX06IOBfpGQiZmXjqCelLazpO7r1vPx4+LexaelmXt6eK+sn4qIg726qevnz/Dt2sTBr3Rzc+nlyv///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAEAACAALAAAAAAvACMAAAb/QJBwSCwaj8ik8mg4BAifqDS6IAgoiKWWSJkApuAw9ZDdHhGCr3gtDhTMxDR7vnabGwu6XgwYaAdqe4JTAUoDg4hgE0iHiY5RhUUNgY+JB0VQiRgQYBIPewBvQgaJFRAeEVMRHp97kSABiRkeHgpSqx4MggBDlHoWtB5SEsGIBiAFiBXBuVEOwRKDAiCkgwzMDhUJzBe2e9PVgtvMFgrMHpzfyInPwRofD+SC0yC+dNesuh8JFx4OHYOOwUqUwJsUBQkQ8RpVqeGHVyAyOVQoSkgBexPnXCrSKKMeiEQ6eqxjCONIkEfwjJzSB46clQTgCEFj0tECmVwC1FxDQGKUK4o4hTRwQgAjgQkCDJQ5EAhl0KAIOEjx87TqkAICNnygZ7VrgwECu4olEgQAOw==)top left no-repeat;border:0}.postDesc{font-size:12px;color:#999}.postDesc{border-bottom:1px dashed #e8e7d0;text-align:right;margin:20px 0;padding:5px 0}.post{padding:32px}.forFlow{margin-bottom:10px}.forFlow p{margin-bottom:18px}h4{background-color:#f60;padding:0 32px;color:#fff}#cnblogs_post_body{font-size:14px}code[class*="language-"],pre[class*="language-"]{color:#393a34;font-family:"Consolas","Bitstream Vera Sans Mono","Courier New",Courier,monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}pre>code[class*="language-"]{font-size:1em}pre[class*="language-"]::selection,pre[class*="language-"] ::selection,code[class*="language-"]::selection,code[class*="language-"] ::selection{background:#c1def1}pre[class*="language-"]{padding:1em;overflow:auto;border:1px solid #ddd;background-color:white}:not(pre)>code[class*="language-"]{padding:.2em;padding-top:1px;padding-bottom:1px;background:#f8f8f8;border:1px solid #ddd}.token.comment{color:#008000;font-style:italic}.token.string{color:#a31515}.token.punctuation,.token.operator{color:#393a34}.token.number{color:#36acaa}.token.keyword{color:#00f}.token.function{color:#393a34}.token.class-name{color:#2b91af}</style>
<style media="only screen and (max-width: 767px)">body{font-size:14px !important;-webkit-text-size-adjust:none}.cnblogs-markdown :not(pre,div,td)>code,.blogpost-body :not(pre,div,td)>code{white-space:pre-wrap}#home>#main{width:auto}#mainContent{width:auto;float:none;display:block}.postTitle{padding-right:5px}#mainContent{margin-left:0}.forFlow{margin:0 10px 0 10px}body{min-width:auto}.post{padding:32px 16px}</style>
<link id=favicon rel="shortcut icon" href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzMiAzMiI+PGRlZnM+PGNsaXBQYXRoIGlkPSJwcmVmaXhfX2NsaXAtcGF0aCI+PHBhdGggY2xhc3M9InByZWZpeF9fY2xzLTEiIGQ9Ik0yOS40OCAyNS4yNGMtLjE2LTEuODktLjA4LTEuNS0uMjQtMy4xNmE3Mi4yNCA3Mi4yNCAwIDAwLTItMTAuMzdMMjYgNi4yNWwtMi42IDUuNDEtLjQ0Ljg5cS0uMjQuNDgtLjU0IDFhMjAuNDMgMjAuNDMgMCAwMS0xLjI0IDEuODQgMjAuMDggMjAuMDggMCAwMS0zLjA4IDMuMjQgMTkuNzIgMTkuNzIgMCAwMS0zLjg3IDIuNTNjLS43Mi4zMy0xLjQ1LjcxLTIuMjMgMS0uMzQuMTQtMS4xOS40NC0xLjkzLjY2YTIuNTUgMi41NSAwIDAxLTEuMDctLjNjLS4zNC0xLS44My0yLjI0LTEuMi0zLjE5LS41LTEuMjUtMS0yLjUtMS41MS0zLjczYTU5LjExIDU5LjExIDAgMDAtMy42Mi03LjI1IDU5LjgyIDU5LjgyIDAgMDAxLjUxIDcuOTRjLjMgMS4zLjcgMi41OCAxLjA1IDMuODdTNiAyMi43MSA2LjQ0IDI0YTEuNCAxLjQgMCAwMDEuMjkuOTNjMS4yOCAwIDIuNTcuMDYgMy44Ni4wNXMyLjU5IDAgMy44OC0uMTFhNTYgNTYgMCAwMDcuNzktLjg3Yy0xLjkyLS40OS03LjUtLjgxLTEwLjc5LTEuMDZhNDMgNDMgMCAwMDYuNTMtMS43IDI0LjA2IDI0LjA2IDAgMDA1LjM4LTMuNDVjLjcxLS42MiAxLjIxIDEuODggMi4zOSA1LjI3LjYyIDEuNjkuMzQgMSAxIDIuNjZzMS4zNyA0LjM4IDIuMTcgNmMtLjA3LTEuODItLjMxLTQuNjctLjQ2LTYuNDh6Ii8+PC9jbGlwUGF0aD48Y2xpcFBhdGggaWQ9InByZWZpeF9fY2xpcC1wYXRoLTIiPjxwYXRoIGNsYXNzPSJwcmVmaXhfX2Nscy0xIiBkPSJNMjAuOTIgMy40NmE0LjI1IDQuMjUgMCAwMS4zMSA1Ljg2IDMuOTEgMy45MSAwIDAxLTUuNjYuMjQgNC4yNSA0LjI1IDAgMDEtLjMxLTUuODYgMy45MSAzLjkxIDAgMDE1LjY2LS4yNG0xLjM1LTEuNTRhNS44OSA1Ljg5IDAgMDAtOC41My4zNiA2LjQxIDYuNDEgMCAwMC40OCA4LjgzIDUuOTEgNS45MSAwIDAwOC41My0uMzYgNi40MSA2LjQxIDAgMDAtLjQ4LTguODN6Ii8+PC9jbGlwUGF0aD48c3R5bGU+LnByZWZpeF9fY2xzLTF7ZmlsbDojM2UzYTM5fUBtZWRpYSAocHJlZmVycy1jb2xvci1zY2hlbWU6ZGFyayl7LnByZWZpeF9fY2xzLTF7ZmlsbDojZWZlZmVmfX08L3N0eWxlPjwvZGVmcz48ZyBzdHlsZT0iaXNvbGF0aW9uOmlzb2xhdGUiPjxnIGlkPSJwcmVmaXhfX2xheWVyXzEiIGRhdGEtbmFtZT0ibGF5ZXIgMSI+PHBhdGggY2xhc3M9InByZWZpeF9fY2xzLTEiIGQ9Ik0yOS40OCAyNS4yNGMtLjE2LTEuODktLjA4LTEuNS0uMjQtMy4xNmE3Mi4yNCA3Mi4yNCAwIDAwLTItMTAuMzdMMjYgNi4yNWwtMi42IDUuNDEtLjQ0Ljg5cS0uMjQuNDgtLjU0IDFhMjAuNDMgMjAuNDMgMCAwMS0xLjI0IDEuODQgMjAuMDggMjAuMDggMCAwMS0zLjA4IDMuMjQgMTkuNzIgMTkuNzIgMCAwMS0zLjg3IDIuNTNjLS43Mi4zMy0xLjQ1LjcxLTIuMjMgMS0uMzQuMTQtMS4xOS40NC0xLjkzLjY2YTIuNTUgMi41NSAwIDAxLTEuMDctLjNjLS4zNC0xLS44My0yLjI0LTEuMi0zLjE5LS41LTEuMjUtMS0yLjUtMS41MS0zLjczYTU5LjExIDU5LjExIDAgMDAtMy42Mi03LjI1IDU5LjgyIDU5LjgyIDAgMDAxLjUxIDcuOTRjLjMgMS4zLjcgMi41OCAxLjA1IDMuODdTNiAyMi43MSA2LjQ0IDI0YTEuNCAxLjQgMCAwMDEuMjkuOTNjMS4yOCAwIDIuNTcuMDYgMy44Ni4wNXMyLjU5IDAgMy44OC0uMTFhNTYgNTYgMCAwMDcuNzktLjg3Yy0xLjkyLS40OS03LjUtLjgxLTEwLjc5LTEuMDZhNDMgNDMgMCAwMDYuNTMtMS43IDI0LjA2IDI0LjA2IDAgMDA1LjM4LTMuNDVjLjcxLS42MiAxLjIxIDEuODggMi4zOSA1LjI3LjYyIDEuNjkuMzQgMSAxIDIuNjZzMS4zNyA0LjM4IDIuMTcgNmMtLjA3LTEuODItLjMxLTQuNjctLjQ2LTYuNDh6Ii8+PGcgY2xpcC1wYXRoPSJ1cmwoI3ByZWZpeF9fY2xpcC1wYXRoKSI+PHBhdGggY2xhc3M9InByZWZpeF9fY2xzLTEiIGQ9Ik0tLjg3LS43OGgzNC40MnYzMy4wN0gtLjg3eiIvPjwvZz48cGF0aCBjbGFzcz0icHJlZml4X19jbHMtMSIgZD0iTTIwLjkyIDMuNDZhNC4yNSA0LjI1IDAgMDEuMzEgNS44NiAzLjkxIDMuOTEgMCAwMS01LjY2LjI0IDQuMjUgNC4yNSAwIDAxLS4zMS01Ljg2IDMuOTEgMy45MSAwIDAxNS42Ni0uMjRtMS4zNS0xLjU0YTUuODkgNS44OSAwIDAwLTguNTMuMzYgNi40MSA2LjQxIDAgMDAuNDggOC44MyA1LjkxIDUuOTEgMCAwMDguNTMtLjM2IDYuNDEgNi40MSAwIDAwLS40OC04LjgzeiIvPjxnIGNsaXAtcGF0aD0idXJsKCNwcmVmaXhfX2NsaXAtcGF0aC0yKSI+PHBhdGggY2xhc3M9InByZWZpeF9fY2xzLTEiIGQ9Ik0tLjg3LS43OGgzNC40MnYzMy4wN0gtLjg3eiIvPjwvZz48L2c+PC9nPjwvc3ZnPg==" type=image/svg+xml data-sf-original-href=https://common.cnblogs.com/favicon.svg><link rel=canonical href=https://www.cnblogs.com/LexMoon/p/reactor.html><meta http-equiv=content-security-policy content="default-src 'none'; font-src 'self' data:; img-src 'self' data:; style-src 'unsafe-inline'; media-src 'self' data:; script-src 'unsafe-inline' data:;"><style>img[src="data:,"],source[src="data:,"]{display:none!important}</style></head>
<body class="skin-bluesky has-navbar mathjax2 prismjs-engine">
 
<div id=home>
<div id=main>
 <div id=mainContent>
 <div class=forFlow>
 <div id=post_detail>
 
 <div id=topics>
 <div class=post>
 <h1 class=postTitle>
 
<a id=cb_post_title_url class="postTitle2 vertical-middle" href=https://www.cnblogs.com/LexMoon/p/reactor.html>
 <span role=heading aria-level=2>Project Reactor 响应式编程</span>
 
</a><button class=cnblogs-toc-button title=显示目录导航 aria-expanded=false></button>
 </h1>
 
 <div class=postBody>
 <div id=cnblogs_post_body class="blogpost-body cnblogs-markdown">
<p><div class=toc><div class=toc-container-header>目录</div><ul><li><a href=#%E4%B8%80-%E4%BB%80%E4%B9%88%E6%98%AF%E5%93%8D%E5%BA%94%E5%BC%8F%E7%BC%96%E7%A8%8B rel=noopener>一. 什么是响应式编程?</a><li><a href=#%E4%BA%8C-project-reactor%E4%BB%8B%E7%BB%8D rel=noopener>二. Project Reactor介绍</a><li><a href=#%E4%B8%89-reactor%E6%A0%B8%E5%BF%83%E6%A6%82%E5%BF%B5 rel=noopener>三. Reactor核心概念</a><ul><li><a href=#flux rel=noopener>Flux</a><ul><li><ul><li><a href=#1-just rel=noopener>1. just()</a><li><a href=#2-fromarrayfromiterable%E5%92%8C-fromstream rel=noopener>2. fromArray()，fromIterable()和 fromStream()</a><li><a href=#3-empty rel=noopener>3. empty()</a><li><a href=#4-errorthrowable-error rel=noopener>4. error(Throwable error)</a><li><a href=#5-never%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E4%B8%8D%E5%8C%85%E5%90%AB%E4%BB%BB%E4%BD%95%E6%B6%88%E6%81%AF%E9%80%9A%E7%9F%A5%E7%9A%84%E5%BA%8F%E5%88%97 rel=noopener>5. never()：创建一个不包含任何消息通知的序列。</a><li><a href=#6-rangeint-start-int-count rel=noopener>6. range(int start, int count)</a><li><a href=#7-intervalduration-period%E5%92%8C-intervalduration-delay-duration-period rel=noopener>7. interval(Duration period)和 interval(Duration delay, Duration period)</a><li><a href=#8-intervalmillislong-period%E5%92%8C-intervalmillislong-delay-long-period rel=noopener>8. intervalMillis(long period)和 intervalMillis(long delay, long period)</a></ul></ul><li><a href=#mono rel=noopener>Mono</a><ul><li><ul><li><a href=#1-fromcallablefromcompletionstagefromfuturefromrunnable%E5%92%8C-fromsupplier rel=noopener>1. fromCallable()、fromCompletionStage()、fromFuture()、fromRunnable()和 fromSupplier()</a><li><a href=#2-delayduration-duration%E5%92%8C-delaymillislong-duration rel=noopener>2. delay(Duration duration)和 delayMillis(long duration)</a><li><a href=#3-ignoreelementspublisher-source rel=noopener>3. ignoreElements(Publisher<t> source)</t></a><li><a href=#4-justoremptyoptional-extends-t-data%E5%92%8C-justoremptyt-data rel=noopener>4. justOrEmpty(Optional&lt;? extends T&gt; data)和 justOrEmpty(T data)</a></ul></ul><li><a href=#%E6%93%8D%E4%BD%9C%E7%AC%A6 rel=noopener>操作符</a><ul><li><ul><li><a href=#1-buffer-%E5%92%8C-buffertimeout rel=noopener>1. buffer 和 bufferTimeout</a><li><a href=#2-filter rel=noopener>2. filter</a><li><a href=#3-window rel=noopener>3. window</a><li><a href=#4-zipwith rel=noopener>4. zipWith</a><li><a href=#5-take rel=noopener>5. take</a><li><a href=#6-reduce-%E5%92%8C-reducewith rel=noopener>6. reduce 和 reduceWith</a><li><a href=#7-merge-%E5%92%8C-mergesequential rel=noopener>7. merge 和 mergeSequential</a><li><a href=#8-flatmap-%E5%92%8C-flatmapsequential rel=noopener>8. flatMap 和 flatMapSequential</a><li><a href=#9-concatmap-%E5%92%8C-combinelatest rel=noopener>9. concatMap 和 combineLatest</a></ul></ul></ul><li><a href=#%E5%9B%9B-%E7%BB%93%E6%9D%9F rel=noopener>四. 结束</a></ul></div><p></p>
<h1 id=一-什么是响应式编程>一. 什么是响应式编程?<button class=cnblogs-toc-button title=显示目录导航 aria-expanded=false></button></h1>
<blockquote>
<p>在计算中，响应式编程或反应式编程是一种面向数据流和变化传播的声明式编程范式。这意味着可以在编程语言中很方便地表达静态或动态的数据流，而相关的计算模型会自动将变化的值通过数据流进行传播。</p>
</blockquote>
<p>上面一段话来自维基百科。</p>
<p>响应式编程顾名思义就是在于<code>响应</code>二字，我们需要在某个事件发生时做出响应。</p>
<p>我们现实生活就是对响应式很好的解释，我们人类的举动大多都是基于事件驱动模式，当有人呼喊你的名字，你会根据这个事件来判断要不要进行应答，这个过程其实就是产生事件，然后我们作为消费者对事件进行处理，而我们的处理结果也会继续向下传递。</p>
<p>在响应式编程中，通常是采用异步回调的方式，回调方法的调用和控制则会由响应式框架来完成，对于应用开发来说只需要关注回调方法的实现就可以了。</p>
<p>这里提一个著名的设计原则：好莱坞原则(Hollywood principle)</p>
<p>Don't call us, we will call you.</p>
<p>演员提交简历之后，回家等着就好，演艺公司会主动打电话给你。</p>
<h1 id=二-project-reactor介绍>二. Project Reactor介绍<button class=cnblogs-toc-button title=显示目录导航 aria-expanded=false></button></h1>
<p>Java中最早的Reactor库RxJava借鉴于.Net的Reactor Extensions，后来Jdk在Java9提供了标准化的响应式库实现<code>java.util.concurrent.Flow</code>，再后来，Project Reactor作为第四代响应式编程框架出现，它是一个完全非阻塞响应式编程的基石，直接集成了Java函数式API，特别是CompletableFuture，Stream和Duration。Reactor Netty实现了非阻塞跨进程通信，提升了服务间通信效率。</p>
<p>我们在平常开发中，异步编程无非是使用JUC包下的工具类或者一些Java同步语义。</p>
<ul>
<li>阻塞等待：如 Future.get()</li>
<li>不安全的数据访问：如 ReentrantLock.lock()</li>
<li>异常冒泡：如 try…​catch…​finally</li>
<li>同步阻塞：如 synchronized{ }</li>
<li>Wrapper分配(GC 压力)：如 new Wrapper<t>(event)</t></li>
</ul>
<p>或者自定义线程池，但也会遇到诸如一下的问题。</p>
<ul>
<li>Callable 分配 -- 可能导致 GC 压力。</li>
<li>同步过程强制每个线程执行停-检查操作。</li>
<li>消息的消费可能比生产慢。</li>
<li>使用线程池(ThreadPool)将任务传递给目标线程 -- 通过 FutureTask 方式肯定会产生 GC 压力。</li>
<li>阻塞直至IO回调。</li>
</ul>
<p>上面等等问题都会造成的系统性能瓶颈或者安全问题，在Future.get时我们无法避免阻塞等待，最差情况下程序运行其实还是同步的，使用Reactor不但可以很有效的解决上述问题，还能让我们写出更加简洁明了的代码。</p>
<h1 id=三-reactor核心概念>三. Reactor核心概念<button class=cnblogs-toc-button title=显示目录导航 aria-expanded=false></button></h1>
<blockquote>
<p>代码: <a href=https://github.com/CasterWx/reactor-ppt target=_blank rel=noopener>https://github.com/CasterWx/reactor-ppt</a></p>
</blockquote>
<h2 id=flux>Flux<button class=cnblogs-toc-button title=显示目录导航 aria-expanded=false></button></h2>
<p>Flux 表示的是包含 0 到 N 个元素的异步序列。在该序列中可以包含三种不同类型的消息通知：正常的包含元素的消息、序列结束的消息和序列出错的消息。当消息通知产生时，订阅者中对应的方法 onNext(), onComplete()和 onError()会被调用。</p>
<h4 id=1-just>1. just()<button class=cnblogs-toc-button title=显示目录导航 aria-expanded=false></button></h4>
<p>可以指定序列中包含的全部元素。创建出来的 Flux 序列在发布这些元素之后会自动结束。</p>
<pre class="highlighter-prismjs language-java prismjs-lines-highlighted" highlighted=true><code class="highlighter-prismjs language-java"><span class="token class-name">Flux</span><span class="token punctuation">.</span><span class="token function">just</span><span class="token punctuation">(</span><span class="token string">"hello"</span><span class="token punctuation">,</span> <span class="token string">"world"</span><span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token function">doOnNext</span><span class="token punctuation">(</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"[doOnNext] "</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token function">doOnComplete</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"[doOnComplete]"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>i <span class="token operator">-&gt;</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"[subscribe] "</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 执行结果</span>
<span class="token punctuation">[</span>doOnNext<span class="token punctuation">]</span> hello
<span class="token punctuation">[</span>subscribe<span class="token punctuation">]</span> hello
<span class="token punctuation">[</span>doOnNext<span class="token punctuation">]</span> world
<span class="token punctuation">[</span>subscribe<span class="token punctuation">]</span> world
<span class="token punctuation">[</span>doOnComplete<span class="token punctuation">]</span>
</code></pre>
<h4 id=2-fromarrayfromiterable和-fromstream>2. fromArray()，fromIterable()和 fromStream()<button class=cnblogs-toc-button title=显示目录导航 aria-expanded=false></button></h4>
<p>可以从一个数组、Iterable 对象或 Stream 对象中创建 Flux 对象。</p>
<pre class="highlighter-prismjs language-java prismjs-lines-highlighted" highlighted=true><code class="highlighter-prismjs language-java"><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> arr <span class="token operator">=</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span><span class="token string">"flux"</span><span class="token punctuation">,</span> <span class="token string">"mono"</span><span class="token punctuation">,</span> <span class="token string">"reactor"</span><span class="token punctuation">,</span> <span class="token string">"core"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Flux</span><span class="token punctuation">.</span><span class="token function">fromIterable</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token function">doOnNext</span><span class="token punctuation">(</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"[doOnNext] "</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"[subscribe] "</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//执行结果</span>
<span class="token punctuation">[</span>doOnNext<span class="token punctuation">]</span> flux
<span class="token punctuation">[</span>subscribe<span class="token punctuation">]</span> flux
<span class="token punctuation">[</span>doOnNext<span class="token punctuation">]</span> mono
<span class="token punctuation">[</span>subscribe<span class="token punctuation">]</span> mono
<span class="token punctuation">[</span>doOnNext<span class="token punctuation">]</span> reactor
<span class="token punctuation">[</span>subscribe<span class="token punctuation">]</span> reactor
<span class="token punctuation">[</span>doOnNext<span class="token punctuation">]</span> core
<span class="token punctuation">[</span>subscribe<span class="token punctuation">]</span> core
</code></pre>
<h4 id=3-empty>3. empty()<button class=cnblogs-toc-button title=显示目录导航 aria-expanded=false></button></h4>
<p>创建一个不包含任何元素，只发布结束消息的序列。</p>
<pre class="highlighter-prismjs language-java prismjs-lines-highlighted" highlighted=true><code class="highlighter-prismjs language-java"> <span class="token class-name">Flux</span><span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token function">doOnNext</span><span class="token punctuation">(</span>i <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"[doOnNext] "</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">doOnComplete</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"[DoOnComplete] "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>i <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"[subscribe] "</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//执行结果</span>
<span class="token punctuation">[</span><span class="token class-name">DoOnComplete</span><span class="token punctuation">]</span>
</code></pre>
<h4 id=4-errorthrowable-error>4. error(Throwable error)<button class=cnblogs-toc-button title=显示目录导航 aria-expanded=false></button></h4>
<p>创建一个只包含错误消息的序列。</p>
<pre class="highlighter-prismjs language-java prismjs-lines-highlighted" highlighted=true><code class="highlighter-prismjs language-java"><span class="token keyword">try</span> <span class="token punctuation">{</span>
	<span class="token keyword">int</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>arr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	arr<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token class-name">Flux</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>i <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
	<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"error subscribe"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//执行结果</span>
</code></pre>
<h4 id=5-never创建一个不包含任何消息通知的序列>5. never()：创建一个不包含任何消息通知的序列。<button class=cnblogs-toc-button title=显示目录导航 aria-expanded=false></button></h4>
<pre class="highlighter-prismjs language-java prismjs-lines-highlighted" highlighted=true><code class="highlighter-prismjs language-java"><span class="token class-name">Flux</span><span class="token punctuation">.</span><span class="token function">never</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token function">doOnNext</span><span class="token punctuation">(</span>i <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"doOnNext "</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">doOnComplete</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"doOnComplete"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"subscribe "</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//执行结果</span>
空
</code></pre>
<h4 id=6-rangeint-start-int-count>6. range(int start, int count)<button class=cnblogs-toc-button title=显示目录导航 aria-expanded=false></button></h4>
<p>创建包含从 start 起始的 count 个数量的 Integer 对象的序列。</p>
<pre class="highlighter-prismjs language-java prismjs-lines-highlighted" highlighted=true><code class="highlighter-prismjs language-java"><span class="token class-name">Flux</span><span class="token punctuation">.</span><span class="token function">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token function">doOnNext</span><span class="token punctuation">(</span>i <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"doOnNext "</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">doOnComplete</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"doOnComplete"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"subscribe "</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//执行结果</span>
doOnNext <span class="token number">5</span>
subscribe <span class="token number">5</span>
doOnNext <span class="token number">6</span>
subscribe <span class="token number">6</span>
doOnNext <span class="token number">7</span>
subscribe <span class="token number">7</span>
doOnNext <span class="token number">8</span>
subscribe <span class="token number">8</span>
doOnNext <span class="token number">9</span>
subscribe <span class="token number">9</span>
doOnNext <span class="token number">10</span>
subscribe <span class="token number">10</span>
doOnNext <span class="token number">11</span>
subscribe <span class="token number">11</span>
doOnNext <span class="token number">12</span>
subscribe <span class="token number">12</span>
doOnNext <span class="token number">13</span>
subscribe <span class="token number">13</span>
doOnNext <span class="token number">14</span>
subscribe <span class="token number">14</span>
doOnComplete
</code></pre>
<h4 id=7-intervalduration-period和-intervalduration-delay-duration-period>7. interval(Duration period)和 interval(Duration delay, Duration period)<button class=cnblogs-toc-button title=显示目录导航 aria-expanded=false></button></h4>
<p>创建一个包含了从 0 开始递增的 Long 对象的序列。其中包含的元素按照指定的间隔来发布。除了间隔时间之外，还可以指定起始元素发布之前的延迟时间。</p>
<pre class="highlighter-prismjs language-java prismjs-lines-highlighted" highlighted=true><code class="highlighter-prismjs language-java"><span class="token class-name">Flux</span><span class="token punctuation">.</span><span class="token function">interval</span><span class="token punctuation">(</span><span class="token class-name">Duration</span><span class="token punctuation">.</span><span class="token function">ofSeconds</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">Duration</span><span class="token punctuation">.</span><span class="token function">ofSeconds</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token function">doOnNext</span><span class="token punctuation">(</span>i <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"doOnNext "</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">doOnComplete</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"doOnComplete "</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"subscribe "</span> <span class="token operator">+</span> i <span class="token operator">+</span> <span class="token string">", date: "</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">try</span> <span class="token punctuation">{</span>
	<span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//执行结果</span>
doOnNext <span class="token number">0</span>
subscribe <span class="token number">0</span><span class="token punctuation">,</span> date<span class="token operator">:</span> <span class="token class-name">Fri</span> <span class="token class-name">Jun</span> <span class="token number">25</span> <span class="token number">10</span><span class="token operator">:</span><span class="token number">17</span><span class="token operator">:</span><span class="token number">56</span> CST <span class="token number">2021</span>
doOnNext <span class="token number">1</span>
subscribe <span class="token number">1</span><span class="token punctuation">,</span> date<span class="token operator">:</span> <span class="token class-name">Fri</span> <span class="token class-name">Jun</span> <span class="token number">25</span> <span class="token number">10</span><span class="token operator">:</span><span class="token number">17</span><span class="token operator">:</span><span class="token number">58</span> CST <span class="token number">2021</span>
doOnNext <span class="token number">2</span>
subscribe <span class="token number">2</span><span class="token punctuation">,</span> date<span class="token operator">:</span> <span class="token class-name">Fri</span> <span class="token class-name">Jun</span> <span class="token number">25</span> <span class="token number">10</span><span class="token operator">:</span><span class="token number">18</span><span class="token operator">:</span><span class="token number">00</span> CST <span class="token number">2021</span>
doOnNext <span class="token number">3</span>
subscribe <span class="token number">3</span><span class="token punctuation">,</span> date<span class="token operator">:</span> <span class="token class-name">Fri</span> <span class="token class-name">Jun</span> <span class="token number">25</span> <span class="token number">10</span><span class="token operator">:</span><span class="token number">18</span><span class="token operator">:</span><span class="token number">02</span> CST <span class="token number">2021</span>
</code></pre>
<p>上面实例为什么没有输出doOnComplete, 从第四秒开始，每两秒生产一个元素，等到最后complete时已经到了sleep的十秒时间，主线程main已经推出。</p>
<h4 id=8-intervalmillislong-period和-intervalmillislong-delay-long-period>8. intervalMillis(long period)和 intervalMillis(long delay, long period)<button class=cnblogs-toc-button title=显示目录导航 aria-expanded=false></button></h4>
<p>与 interval()方法的作用相同，只不过该方法通过毫秒数来指定时间间隔和延迟时间。</p>
<h2 id=mono>Mono<button class=cnblogs-toc-button title=显示目录导航 aria-expanded=false></button></h2>
<p>Mono 表示的是包含 0 或者 1 个元素的异步序列。该序列中同样可以包含与 Flux 相同的三种类型的消息通知。</p>
<h4 id=1-fromcallablefromcompletionstagefromfuturefromrunnable和-fromsupplier>1. fromCallable()、fromCompletionStage()、fromFuture()、fromRunnable()和 fromSupplier()<button class=cnblogs-toc-button title=显示目录导航 aria-expanded=false></button></h4>
<p>分别从 Callable、CompletionStage、CompletableFuture、Runnable 和 Supplier 中创建 Mono。</p>
<pre class="highlighter-prismjs language-java prismjs-lines-highlighted" highlighted=true><code class="highlighter-prismjs language-java"> <span class="token class-name">Mono</span><span class="token punctuation">.</span><span class="token function">fromCallable</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"begin callable"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token string">"Hello"</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token function">subscribeOn</span><span class="token punctuation">(</span><span class="token class-name">Schedulers</span><span class="token punctuation">.</span><span class="token function">elastic</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token function">doOnNext</span><span class="token punctuation">(</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"doOnNext "</span> <span class="token operator">+</span> i <span class="token operator">+</span> <span class="token string">", thread :"</span> <span class="token operator">+</span> <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//执行结果</span>
begin callable
doOnNext <span class="token class-name">Hello</span><span class="token punctuation">,</span> thread <span class="token operator">:</span>elastic<span class="token operator">-</span><span class="token number">2</span>
<span class="token class-name">Hello</span>
</code></pre>
<pre class="highlighter-prismjs language-java prismjs-lines-highlighted" highlighted=true><code class="highlighter-prismjs language-java"><span class="token class-name">Mono</span><span class="token punctuation">.</span><span class="token function">fromFuture</span><span class="token punctuation">(</span><span class="token class-name">CompletableFuture</span><span class="token punctuation">.</span><span class="token function">supplyAsync</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"begin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token string">"hello"</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token function">subscribeOn</span><span class="token punctuation">(</span><span class="token class-name">Schedulers</span><span class="token punctuation">.</span><span class="token function">elastic</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token function">doOnNext</span><span class="token punctuation">(</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"doOnNext "</span> <span class="token operator">+</span> i <span class="token operator">+</span> <span class="token string">", thread :"</span> <span class="token operator">+</span> <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//执行结果</span>
begin
doOnNext hello<span class="token punctuation">,</span> thread <span class="token operator">:</span>elastic<span class="token operator">-</span><span class="token number">2</span>
hello
</code></pre>
<h4 id=2-delayduration-duration和-delaymillislong-duration>2. delay(Duration duration)和 delayMillis(long duration)<button class=cnblogs-toc-button title=显示目录导航 aria-expanded=false></button></h4>
<p>创建一个 Mono 序列，在指定的延迟时间之后，产生数字 0 作为唯一值。</p>
<pre class="highlighter-prismjs language-java prismjs-lines-highlighted" highlighted=true><code class="highlighter-prismjs language-java"><span class="token class-name">Mono</span><span class="token punctuation">.</span><span class="token function">delay</span><span class="token punctuation">(</span><span class="token class-name">Duration</span><span class="token punctuation">.</span><span class="token function">ofSeconds</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//执行结果, 延迟一秒后打印</span>
<span class="token number">0</span>
</code></pre>
<h4 id=3-ignoreelementspublisher-source>3. ignoreElements(Publisher<t> source)</t><button class=cnblogs-toc-button title=显示目录导航 aria-expanded=false></button></h4>
<p>创建一个 Mono 序列，忽略作为源的 Publisher 中的所有元素，只产生结束消息。</p>
<pre class="highlighter-prismjs language-java prismjs-lines-highlighted" highlighted=true><code class="highlighter-prismjs language-java"><span class="token class-name">Mono</span><span class="token punctuation">.</span><span class="token function">ignoreElements</span><span class="token punctuation">(</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"ignoreElements"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token function">doOnNext</span><span class="token punctuation">(</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"doOnNext "</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//执行结果</span>
ignoreElements
</code></pre>
<h4 id=4-justoremptyoptional-extends-t-data和-justoremptyt-data>4. justOrEmpty(Optional&lt;? extends T&gt; data)和 justOrEmpty(T data)<button class=cnblogs-toc-button title=显示目录导航 aria-expanded=false></button></h4>
<p>从一个 Optional 对象或可能为 null 的对象中创建 Mono。只有 Optional 对象中包含值或对象不为 null 时，Mono 序列才产生对应的元素。</p>
<pre class="highlighter-prismjs language-java prismjs-lines-highlighted" highlighted=true><code class="highlighter-prismjs language-java"><span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> optional <span class="token operator">=</span> <span class="token class-name">Optional</span><span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Mono</span><span class="token punctuation">.</span><span class="token function">justOrEmpty</span><span class="token punctuation">(</span>optional<span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token function">doOnNext</span><span class="token punctuation">(</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"doOnNext "</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"========"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

optional <span class="token operator">=</span> <span class="token class-name">Optional</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Mono</span><span class="token punctuation">.</span><span class="token function">justOrEmpty</span><span class="token punctuation">(</span>optional<span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token function">doOnNext</span><span class="token punctuation">(</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"doOnNext "</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//执行结果</span>
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>
doOnNext <span class="token number">100</span>
<span class="token number">100</span>
</code></pre>
<h2 id=操作符>操作符<button class=cnblogs-toc-button title=显示目录导航 aria-expanded=false></button></h2>
<h4 id=1-buffer-和-buffertimeout>1. buffer 和 bufferTimeout<button class=cnblogs-toc-button title=显示目录导航 aria-expanded=false></button></h4>
<p>这两个操作符的作用是把当前流中的元素收集到集合中，并把集合对象作为流中的新元素。在进行收集时可以指定不同的条件：所包含的元素的最大数量或收集的时间间隔。方法 buffer()仅使用一个条件，而 bufferTimeout()可以同时指定两个条件。指定时间间隔时可以使用 Duration 对象或毫秒数，即使用 bufferMillis()或 bufferTimeoutMillis()两个方法。</p>
<p>除了元素数量和时间间隔之外，还可以通过 bufferUntil 和 bufferWhile 操作符来进行收集。这两个操作符的参数是表示每个集合中的元素所要满足的条件的 Predicate 对象。bufferUntil 会一直收集直到 Predicate 返回为 true。使得 Predicate 返回 true 的那个元素可以选择添加到当前集合或下一个集合中；bufferWhile 则只有当 Predicate 返回 true 时才会收集。一旦值为 false，会立即开始下一次收集。</p>
<pre class="highlighter-prismjs language-none prismjs-lines-highlighted" highlighted=true><code class="highlighter-prismjs language-none">Flux.range(1, 100).buffer(20).subscribe(System.out::println);

//执行结果
[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
[21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40]
[41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60]
[61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80]
[81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100]
</code></pre>
<h4 id=2-filter>2. filter<button class=cnblogs-toc-button title=显示目录导航 aria-expanded=false></button></h4>
<p>对流中包含的元素进行过滤，只留下满足 Predicate 指定条件的元素。</p>
<pre class="highlighter-prismjs language-java prismjs-lines-highlighted" highlighted=true><code class="highlighter-prismjs language-java"><span class="token class-name">Flux</span><span class="token punctuation">.</span><span class="token function">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>i <span class="token operator">-&gt;</span> i<span class="token operator">%</span><span class="token number">2</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">doOnNext</span><span class="token punctuation">(</span>i <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
		<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"[doOnNext] "</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>i <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
		<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"subscribe "</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//执行结果</span>
<span class="token punctuation">[</span>doOnNext<span class="token punctuation">]</span> <span class="token number">2</span>
subscribe <span class="token number">2</span>
<span class="token punctuation">[</span>doOnNext<span class="token punctuation">]</span> <span class="token number">4</span>
subscribe <span class="token number">4</span>
<span class="token punctuation">[</span>doOnNext<span class="token punctuation">]</span> <span class="token number">6</span>
subscribe <span class="token number">6</span>
<span class="token punctuation">[</span>doOnNext<span class="token punctuation">]</span> <span class="token number">8</span>
subscribe <span class="token number">8</span>
<span class="token punctuation">[</span>doOnNext<span class="token punctuation">]</span> <span class="token number">10</span>
subscribe <span class="token number">10</span>
</code></pre>
<h4 id=3-window>3. window<button class=cnblogs-toc-button title=显示目录导航 aria-expanded=false></button></h4>
<p>window 操作符的作用类似于 buffer，所不同的是 window 操作符是把当前流中的元素收集到另外的 Flux 序列中，因此返回值类型是 Flux<flux>。</flux></p>
<pre class="highlighter-prismjs language-java prismjs-lines-highlighted" highlighted=true><code class="highlighter-prismjs language-java"><span class="token class-name">Flux</span><span class="token punctuation">.</span><span class="token function">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">window</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token function">doOnNext</span><span class="token punctuation">(</span><span class="token punctuation">(</span>flux <span class="token operator">-&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>flux <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
		flux<span class="token punctuation">.</span><span class="token function">doOnNext</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
			<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"[window] flux: "</span> <span class="token operator">+</span> item<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token function">doOnComplete</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"flux item complete"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 执行结果</span>
<span class="token punctuation">[</span>window<span class="token punctuation">]</span> flux<span class="token operator">:</span> <span class="token number">1</span>
<span class="token punctuation">[</span>window<span class="token punctuation">]</span> flux<span class="token operator">:</span> <span class="token number">2</span>
<span class="token punctuation">[</span>window<span class="token punctuation">]</span> flux<span class="token operator">:</span> <span class="token number">3</span>
<span class="token punctuation">[</span>window<span class="token punctuation">]</span> flux<span class="token operator">:</span> <span class="token number">4</span>
<span class="token punctuation">[</span>window<span class="token punctuation">]</span> flux<span class="token operator">:</span> <span class="token number">5</span>
flux item complete
<span class="token punctuation">[</span>window<span class="token punctuation">]</span> flux<span class="token operator">:</span> <span class="token number">6</span>
<span class="token punctuation">[</span>window<span class="token punctuation">]</span> flux<span class="token operator">:</span> <span class="token number">7</span>
<span class="token punctuation">[</span>window<span class="token punctuation">]</span> flux<span class="token operator">:</span> <span class="token number">8</span>
<span class="token punctuation">[</span>window<span class="token punctuation">]</span> flux<span class="token operator">:</span> <span class="token number">9</span>
<span class="token punctuation">[</span>window<span class="token punctuation">]</span> flux<span class="token operator">:</span> <span class="token number">10</span>
flux item complete
<span class="token punctuation">[</span>window<span class="token punctuation">]</span> flux<span class="token operator">:</span> <span class="token number">11</span>
<span class="token punctuation">[</span>window<span class="token punctuation">]</span> flux<span class="token operator">:</span> <span class="token number">12</span>
<span class="token punctuation">[</span>window<span class="token punctuation">]</span> flux<span class="token operator">:</span> <span class="token number">13</span>
<span class="token punctuation">[</span>window<span class="token punctuation">]</span> flux<span class="token operator">:</span> <span class="token number">14</span>
<span class="token punctuation">[</span>window<span class="token punctuation">]</span> flux<span class="token operator">:</span> <span class="token number">15</span>
flux item complete
</code></pre>
<h4 id=4-zipwith>4. zipWith<button class=cnblogs-toc-button title=显示目录导航 aria-expanded=false></button></h4>
<p>zipWith 操作符把当前流中的元素与另外一个流中的元素按照一对一的方式进行合并。在合并时可以不做任何处理，由此得到的是一个元素类型为 Tuple2 的流；也可以通过一个 BiFunction 函数对合并的元素进行处理，所得到的流的元素类型为该函数的返回值。</p>
<pre class="highlighter-prismjs language-java prismjs-lines-highlighted" highlighted=true><code class="highlighter-prismjs language-java"><span class="token class-name">Flux</span><span class="token punctuation">.</span><span class="token function">just</span><span class="token punctuation">(</span><span class="token string">"Hello"</span><span class="token punctuation">,</span> <span class="token string">"Project"</span><span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token function">zipWith</span><span class="token punctuation">(</span><span class="token class-name">Flux</span><span class="token punctuation">.</span><span class="token function">just</span><span class="token punctuation">(</span><span class="token string">"World"</span><span class="token punctuation">,</span> <span class="token string">"Reactor"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"======"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">Flux</span><span class="token punctuation">.</span><span class="token function">just</span><span class="token punctuation">(</span><span class="token string">"Hello"</span><span class="token punctuation">,</span> <span class="token string">"Project"</span><span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token function">zipWith</span><span class="token punctuation">(</span><span class="token class-name">Flux</span><span class="token punctuation">.</span><span class="token function">just</span><span class="token punctuation">(</span><span class="token string">"World"</span><span class="token punctuation">,</span> <span class="token string">"Reactor"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>s1<span class="token punctuation">,</span> s2<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"%s!%s!"</span><span class="token punctuation">,</span> s1<span class="token punctuation">,</span> s2<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 执行结果</span>
<span class="token class-name">Hello</span><span class="token punctuation">,</span><span class="token class-name">World</span>
<span class="token class-name">Project</span><span class="token punctuation">,</span><span class="token class-name">Reactor</span>
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>
<span class="token class-name">Hello</span><span class="token operator">!</span><span class="token class-name">World</span><span class="token operator">!</span>
<span class="token class-name">Project</span><span class="token operator">!</span><span class="token class-name">Reactor</span><span class="token operator">!</span>
</code></pre>
<h4 id=5-take>5. take<button class=cnblogs-toc-button title=显示目录导航 aria-expanded=false></button></h4>
<p>take 系列操作符用来从当前流中提取元素。提取的方式可以有很多种。</p>
<p>take(long n)，take(Duration timespan)和 takeMillis(long timespan)：按照指定的数量或时间间隔来提取。</p>
<pre class="highlighter-prismjs language-java prismjs-lines-highlighted" highlighted=true><code class="highlighter-prismjs language-java"><span class="token class-name">Flux</span><span class="token punctuation">.</span><span class="token function">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">take</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 执行结果</span>
<span class="token number">1</span>
<span class="token number">2</span>
</code></pre>
<ol>
<li>takeLast(long n)：提取流中的最后 N 个元素。</li>
</ol>
<pre class="highlighter-prismjs language-java prismjs-lines-highlighted" highlighted=true><code class="highlighter-prismjs language-java"><span class="token class-name">Flux</span><span class="token punctuation">.</span><span class="token function">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">takeLast</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 执行结果</span>
<span class="token number">9</span>
<span class="token number">10</span>
</code></pre>
<ol start=2>
<li>takeUntil(Predicate&lt;? super T&gt; predicate)：提取元素直到 Predicate 返回 true。</li>
</ol>
<pre class="highlighter-prismjs language-java prismjs-lines-highlighted" highlighted=true><code class="highlighter-prismjs language-java"><span class="token class-name">Flux</span><span class="token punctuation">.</span><span class="token function">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">takeUntil</span><span class="token punctuation">(</span>i <span class="token operator">-&gt;</span> i <span class="token operator">==</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 执行结果</span>
<span class="token number">1</span>
<span class="token number">2</span>
<span class="token number">3</span>
<span class="token number">4</span>
<span class="token number">5</span>
<span class="token number">6</span>
</code></pre>
<ol start=3>
<li>takeWhile(Predicate&lt;? super T&gt; continuePredicate)： 当 Predicate 返回 true 时才进行提取。</li>
</ol>
<pre class="highlighter-prismjs language-java prismjs-lines-highlighted" highlighted=true><code class="highlighter-prismjs language-java"><span class="token class-name">Flux</span><span class="token punctuation">.</span><span class="token function">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">takeWhile</span><span class="token punctuation">(</span>i <span class="token operator">-&gt;</span> i <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 执行结果</span>
<span class="token number">1</span>
<span class="token number">2</span>
<span class="token number">3</span>
<span class="token number">4</span>
</code></pre>
<ol start=4>
<li>takeUntilOther(Publisher&lt;?&gt; other)：提取元素直到另外一个流开始产生元素。</li>
</ol>
<pre class="highlighter-prismjs language-java prismjs-lines-highlighted" highlighted=true><code class="highlighter-prismjs language-java"><span class="token class-name">Flux</span><span class="token punctuation">.</span><span class="token function">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">takeUntilOther</span><span class="token punctuation">(</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
	<span class="token keyword">try</span> <span class="token punctuation">{</span>
		<span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 执行结果，暂停1000ms后开始输出</span>
<span class="token number">1</span>
<span class="token number">2</span>
<span class="token number">3</span>
<span class="token number">4</span>
<span class="token number">5</span>
</code></pre>
<h4 id=6-reduce-和-reducewith>6. reduce 和 reduceWith<button class=cnblogs-toc-button title=显示目录导航 aria-expanded=false></button></h4>
<p>reduce 和 reduceWith 操作符对流中包含的所有元素进行累积操作，得到一个包含计算结果的 Mono 序列。累积操作是通过一个 BiFunction 来表示的。在操作时可以指定一个初始值。如果没有初始值，则序列的第一个元素作为初始值。</p>
<pre class="highlighter-prismjs language-java prismjs-lines-highlighted" highlighted=true><code class="highlighter-prismjs language-java"><span class="token class-name">Flux</span><span class="token punctuation">.</span><span class="token function">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
		<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"x:"</span> <span class="token operator">+</span> x <span class="token operator">+</span> <span class="token string">", y:"</span> <span class="token operator">+</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> x<span class="token operator">+</span>y<span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 执行结果</span>
x<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span> y<span class="token operator">:</span><span class="token number">2</span>
x<span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">,</span> y<span class="token operator">:</span><span class="token number">3</span>
x<span class="token operator">:</span><span class="token number">6</span><span class="token punctuation">,</span> y<span class="token operator">:</span><span class="token number">4</span>
x<span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">,</span> y<span class="token operator">:</span><span class="token number">5</span>
x<span class="token operator">:</span><span class="token number">15</span><span class="token punctuation">,</span> y<span class="token operator">:</span><span class="token number">6</span>
x<span class="token operator">:</span><span class="token number">21</span><span class="token punctuation">,</span> y<span class="token operator">:</span><span class="token number">7</span>
x<span class="token operator">:</span><span class="token number">28</span><span class="token punctuation">,</span> y<span class="token operator">:</span><span class="token number">8</span>
x<span class="token operator">:</span><span class="token number">36</span><span class="token punctuation">,</span> y<span class="token operator">:</span><span class="token number">9</span>
x<span class="token operator">:</span><span class="token number">45</span><span class="token punctuation">,</span> y<span class="token operator">:</span><span class="token number">10</span>
<span class="token number">55</span>
</code></pre>
<pre class="highlighter-prismjs language-java prismjs-lines-highlighted" highlighted=true><code class="highlighter-prismjs language-java"><span class="token class-name">Flux</span><span class="token punctuation">.</span><span class="token function">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token function">reduceWith</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
	 <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"x:"</span> <span class="token operator">+</span> x <span class="token operator">+</span> <span class="token string">", y:"</span> <span class="token operator">+</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">return</span> x<span class="token operator">+</span>y<span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 执行结果</span>
x<span class="token operator">:</span><span class="token number">100</span><span class="token punctuation">,</span> y<span class="token operator">:</span><span class="token number">1</span>
x<span class="token operator">:</span><span class="token number">101</span><span class="token punctuation">,</span> y<span class="token operator">:</span><span class="token number">2</span>
x<span class="token operator">:</span><span class="token number">103</span><span class="token punctuation">,</span> y<span class="token operator">:</span><span class="token number">3</span>
x<span class="token operator">:</span><span class="token number">106</span><span class="token punctuation">,</span> y<span class="token operator">:</span><span class="token number">4</span>
x<span class="token operator">:</span><span class="token number">110</span><span class="token punctuation">,</span> y<span class="token operator">:</span><span class="token number">5</span>
x<span class="token operator">:</span><span class="token number">115</span><span class="token punctuation">,</span> y<span class="token operator">:</span><span class="token number">6</span>
x<span class="token operator">:</span><span class="token number">121</span><span class="token punctuation">,</span> y<span class="token operator">:</span><span class="token number">7</span>
x<span class="token operator">:</span><span class="token number">128</span><span class="token punctuation">,</span> y<span class="token operator">:</span><span class="token number">8</span>
x<span class="token operator">:</span><span class="token number">136</span><span class="token punctuation">,</span> y<span class="token operator">:</span><span class="token number">9</span>
x<span class="token operator">:</span><span class="token number">145</span><span class="token punctuation">,</span> y<span class="token operator">:</span><span class="token number">10</span>
<span class="token number">155</span>
</code></pre>
<h4 id=7-merge-和-mergesequential>7. merge 和 mergeSequential<button class=cnblogs-toc-button title=显示目录导航 aria-expanded=false></button></h4>
<p>merge 和 mergeSequential 操作符用来把多个流合并成一个 Flux 序列。不同之处在于 merge 按照所有流中元素的实际产生顺序来合并，而 mergeSequential 则按照所有流被订阅的顺序，以流为单位进行合并。</p>
<pre class="highlighter-prismjs language-java prismjs-lines-highlighted" highlighted=true><code class="highlighter-prismjs language-java"><span class="token class-name">Flux</span><span class="token punctuation">.</span><span class="token function">merge</span><span class="token punctuation">(</span><span class="token class-name">Flux</span><span class="token punctuation">.</span><span class="token function">interval</span><span class="token punctuation">(</span>
	<span class="token class-name">Duration</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token class-name">ChronoUnit</span><span class="token punctuation">.</span>MILLIS<span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token class-name">Duration</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token class-name">ChronoUnit</span><span class="token punctuation">.</span>MILLIS<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">take</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token class-name">Flux</span><span class="token punctuation">.</span><span class="token function">interval</span><span class="token punctuation">(</span>
		<span class="token class-name">Duration</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token class-name">ChronoUnit</span><span class="token punctuation">.</span>MILLIS<span class="token punctuation">)</span><span class="token punctuation">,</span>
		<span class="token class-name">Duration</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token class-name">ChronoUnit</span><span class="token punctuation">.</span>MILLIS<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">take</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token function">toStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"=============="</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Flux</span><span class="token punctuation">.</span><span class="token function">mergeSequential</span><span class="token punctuation">(</span><span class="token class-name">Flux</span><span class="token punctuation">.</span><span class="token function">interval</span><span class="token punctuation">(</span>
	<span class="token class-name">Duration</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token class-name">ChronoUnit</span><span class="token punctuation">.</span>MILLIS<span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token class-name">Duration</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token class-name">ChronoUnit</span><span class="token punctuation">.</span>MILLIS<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">take</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token class-name">Flux</span><span class="token punctuation">.</span><span class="token function">interval</span><span class="token punctuation">(</span>
		<span class="token class-name">Duration</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token class-name">ChronoUnit</span><span class="token punctuation">.</span>MILLIS<span class="token punctuation">)</span><span class="token punctuation">,</span>
		<span class="token class-name">Duration</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token class-name">ChronoUnit</span><span class="token punctuation">.</span>MILLIS<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">take</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token function">toStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 执行结果</span>
<span class="token number">0</span>
<span class="token number">0</span>
<span class="token number">1</span>
<span class="token number">1</span>
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>
<span class="token number">0</span>
<span class="token number">1</span>
<span class="token number">0</span>
<span class="token number">1</span>
</code></pre>
<h4 id=8-flatmap-和-flatmapsequential>8. flatMap 和 flatMapSequential<button class=cnblogs-toc-button title=显示目录导航 aria-expanded=false></button></h4>
<p>flatMap 和 flatMapSequential 操作符把流中的每个元素转换成一个流，再把所有流中的元素进行合并。flatMapSequential 和 flatMap 之间的区别与 mergeSequential 和 merge 之间的区别是一样的。</p>
<pre class="highlighter-prismjs language-none prismjs-lines-highlighted" highlighted=true><code class="highlighter-prismjs language-none">Flux.just(1, 2)
	.flatMap(x -&gt; Flux.interval(Duration.of(x * 10, ChronoUnit.MILLIS), Duration.of(10, ChronoUnit.MILLIS)).take(x))
	.toStream()
	.forEach(System.out::println);
// 执行结果
0
0
1
</code></pre>
<h4 id=9-concatmap-和-combinelatest>9. concatMap 和 combineLatest<button class=cnblogs-toc-button title=显示目录导航 aria-expanded=false></button></h4>
<p>concatMap 操作符的作用也是把流中的每个元素转换成一个流，再把所有流进行合并。与 flatMap 不同的是，concatMap 会根据原始流中的元素顺序依次把转换之后的流进行合并；与 flatMapSequential 不同的是，concatMap 对转换之后的流的订阅是动态进行的，而 flatMapSequential 在合并之前就已经订阅了所有的流。</p>
<pre class="highlighter-prismjs language-java prismjs-lines-highlighted" highlighted=true><code class="highlighter-prismjs language-java"><span class="token class-name">Flux</span><span class="token punctuation">.</span><span class="token function">just</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token function">concatMap</span><span class="token punctuation">(</span>x <span class="token operator">-&gt;</span> <span class="token class-name">Flux</span><span class="token punctuation">.</span><span class="token function">intervalMillis</span><span class="token punctuation">(</span>x <span class="token operator">*</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">take</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token function">toStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">Flux</span><span class="token punctuation">.</span><span class="token function">combineLatest</span><span class="token punctuation">(</span>
	<span class="token class-name">Arrays</span><span class="token operator">::</span><span class="token function">toString</span><span class="token punctuation">,</span>
	<span class="token class-name">Flux</span><span class="token punctuation">.</span><span class="token function">intervalMillis</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">take</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token class-name">Flux</span><span class="token punctuation">.</span><span class="token function">intervalMillis</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">take</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h1 id=四-结束>四. 结束<button class=cnblogs-toc-button title=显示目录导航 aria-expanded=false></button></h1>
<p>上文已经简单介绍了Reactor的两个核心概念Flux和Mono，以及一些常用操作符的使用，刚开始使用响应式编程范式对于部分开发人员来说可能极度困难，但熟能生巧，长期使用让思维方式转变才能领会到响应式编程的优点。</p>
</div>
<div id=blog_post_info_block role=contentinfo><div id=BlogPostCategory>
 分类: 
 <a href=https://www.cnblogs.com/LexMoon/category/1125144.html target=_blank>Java</a></div>
 
 
 <div id=post_next_prev>
 <a href=https://www.cnblogs.com/LexMoon/p/java_loom.html class=p_n_p_prefix>« </a> 上一篇： <a href=https://www.cnblogs.com/LexMoon/p/java_loom.html data-featured-image title="发布于 2021-06-16 10:38">Java协程实践指南(一)</a>
 <br>
 <a href=https://www.cnblogs.com/LexMoon/p/14971718.html class=p_n_p_prefix>» </a> 下一篇： <a href=https://www.cnblogs.com/LexMoon/p/14971718.html data-featured-image title="发布于 2021-07-05 11:40">监控杂谈</a>
</div>
</div>
 </div>
 <div class=postDesc>posted @ 
<span id=post-date>2021-06-25 12:17</span>&nbsp;
<a href=https://www.cnblogs.com/LexMoon/>AntzUhl</a>&nbsp;
阅读(<span id=post_view_count>1693</span>)&nbsp;
评论(<span id=post_comment_count>0</span>)&nbsp;
<a href="https://i.cnblogs.com/EditPosts.aspx?postid=14930392" rel=nofollow>编辑</a>&nbsp;
<a>收藏</a>&nbsp;
<a>举报</a></div>
 </div>
 
 
 </div>
</div>
 </div>
 </div>
 
 
 </div>
 
 
</div>
<script>document.currentScript.remove();!function(){"use strict";(t=>{const n="singlefile-infobar",e="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABAAgMAAADXB5lNAAABhmlDQ1BJQ0MgcHJvZmlsZQAAKJF9kj1Iw0AYht+mSkUrDnYQcchQnSyIijqWKhbBQmkrtOpgcukfNGlIUlwcBdeCgz+LVQcXZ10dXAVB8AfEydFJ0UVK/C4ptIjx4LiH9+59+e67A4RGhalm1wSgapaRisfEbG5VDLyiDwEAvZiVmKkn0osZeI6ve/j4ehfhWd7n/hz9St5kgE8kjjLdsIg3iGc2LZ3zPnGIlSSF+Jx43KACiR+5Lrv8xrnosMAzQ0YmNU8cIhaLHSx3MCsZKvE0cVhRNcoXsi4rnLc4q5Uaa9XJbxjMaytprtMcQRxLSCAJETJqKKMCCxFaNVJMpGg/5uEfdvxJcsnkKoORYwFVqJAcP/gb/O6tWZiadJOCMaD7xbY/RoHALtCs2/b3sW03TwD/M3Cltf3VBjD3SXq9rYWPgIFt4OK6rcl7wOUOMPSkS4bkSH6aQqEAvJ/RM+WAwVv6EGtu31r7OH0AMtSr5Rvg4BAYK1L2use9ezr79u+ZVv9+AFlNcp0UUpiqAAAACXBIWXMAAC4jAAAuIwF4pT92AAAAB3RJTUUH5AsHAB8H+DhhoQAAABl0RVh0Q29tbWVudABDcmVhdGVkIHdpdGggR0lNUFeBDhcAAAAJUExURQAAAICHi4qKioTuJAkAAAABdFJOUwBA5thmAAAAAWJLR0QCZgt8ZAAAAJJJREFUOI3t070NRCEMA2CnYAOyDyPwpHj/Va7hJ3FzV7zy3ET5JIwoAF6Jk4wzAJAkzxAYG9YRTgB+24wBgKmfrGAKTcEfAY4KRlRoIeBTgKOCERVaCPgU4Khge2GqKOBTgKOCERVaAEC/4PNcnyoSWHpjqkhwKxbcig0Q6AorXYF/+A6eIYD1lVbwG/jdA6/kA2THRAURVubcAAAAAElFTkSuQmCC",o="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABAAgMAAADXB5lNAAABhmlDQ1BJQ0MgcHJvZmlsZQAAKJF9kj1Iw0AYht+mSkUrDnYQcchQnSyIijqWKhbBQmkrtOpgcukfNGlIUlwcBdeCgz+LVQcXZ10dXAVB8AfEydFJ0UVK/C4ptIjx4LiH9+59+e67A4RGhalm1wSgapaRisfEbG5VDLyiDwEAvZiVmKkn0osZeI6ve/j4ehfhWd7n/hz9St5kgE8kjjLdsIg3iGc2LZ3zPnGIlSSF+Jx43KACiR+5Lrv8xrnosMAzQ0YmNU8cIhaLHSx3MCsZKvE0cVhRNcoXsi4rnLc4q5Uaa9XJbxjMaytprtMcQRxLSCAJETJqKKMCCxFaNVJMpGg/5uEfdvxJcsnkKoORYwFVqJAcP/gb/O6tWZiadJOCMaD7xbY/RoHALtCs2/b3sW03TwD/M3Cltf3VBjD3SXq9rYWPgIFt4OK6rcl7wOUOMPSkS4bkSH6aQqEAvJ/RM+WAwVv6EGtu31r7OH0AMtSr5Rvg4BAYK1L2use9ezr79u+ZVv9+AFlNcp0UUpiqAAAACXBIWXMAAC4jAAAuIwF4pT92AAAAB3RJTUUH5AsHAB8VC4EQ6QAAABl0RVh0Q29tbWVudABDcmVhdGVkIHdpdGggR0lNUFeBDhcAAAAJUExURQAAAICHi4qKioTuJAkAAAABdFJOUwBA5thmAAAAAWJLR0QCZgt8ZAAAAJtJREFUOI3NkrsBgCAMRLFwBPdxBArcfxXFkO8rbKWAAJfHJ9faf9vuYX/749T5NmShm3bEwbe2SxeuM4+2oxDL1cDoKtVUjRy+tH78Cv2CS+wIiQNC1AEhk4AQeUTMWUJMfUJMSEJMSEY8kIx4IONroaYAimNxsXp1PA7PxwfVL8QnowwoVC0lig07wDDVUjAdbAnjwtow/z/bDW7eI4M2KruJAAAAAElFTkSuQmCC",i="SingleFile",A="single-file-ui-element",r="\n\t.infobar {\n\t\tbackground-color: #737373;\n\t\tcolor: white;\n\t\tdisplay: flex;\n\t\tposition: fixed;\n\t\ttop: 16px;\n\t\tright: 16px;\n\t\theight: auto;\n\t\twidth: auto;\n\t\tmin-height: 24px;\n\t\tmin-width: 24px;\n\t\tbackground-position: center;\n\t\tbackground-repeat: no-repeat;\n\t\tz-index: 2147483647;\n\t\tmargin: 0 0 0 16px;\n\t\tbackground-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABABAMAAABYR2ztAAABhmlDQ1BJQ0MgcHJvZmlsZQAAKJF9kj1Iw0AYht+mSkUrDnYQcchQnSyIijqWKhbBQmkrtOpgcukfNGlIUlwcBdeCgz+LVQcXZ10dXAVB8AfEydFJ0UVK/C4ptIjx4LiH9+59+e67A4RGhalm1wSgapaRisfEbG5VDLyiDwEAvZiVmKkn0osZeI6ve/j4ehfhWd7n/hz9St5kgE8kjjLdsIg3iGc2LZ3zPnGIlSSF+Jx43KACiR+5Lrv8xrnosMAzQ0YmNU8cIhaLHSx3MCsZKvE0cVhRNcoXsi4rnLc4q5Uaa9XJbxjMaytprtMcQRxLSCAJETJqKKMCCxFaNVJMpGg/5uEfdvxJcsnkKoORYwFVqJAcP/gb/O6tWZiadJOCMaD7xbY/RoHALtCs2/b3sW03TwD/M3Cltf3VBjD3SXq9rYWPgIFt4OK6rcl7wOUOMPSkS4bkSH6aQqEAvJ/RM+WAwVv6EGtu31r7OH0AMtSr5Rvg4BAYK1L2use9ezr79u+ZVv9+AFlNcp0UUpiqAAAACXBIWXMAAC4jAAAuIwF4pT92AAAAB3RJTUUH5AsHADIRLMaOHwAAABl0RVh0Q29tbWVudABDcmVhdGVkIHdpdGggR0lNUFeBDhcAAAAPUExURQAAAIqKioyNjY2OjvDw8L2y1DEAAAABdFJOUwBA5thmAAAAAWJLR0QB/wIt3gAAAGNJREFUSMdjYCAJsLi4OBCQx6/CBQwIGIDPCBcXAkYQUsACU+AwlBVQHg6Eg5pgZBGOboIJZugDFwRwoJECJCUOhJI1wZwzqmBUwagCuipgIqTABG9h7YIKaKGAURAFEF/6AQAO4HqSoDP8bgAAAABJRU5ErkJggg==);\n\t\tborder-radius: 16px;\n\t\tuser-select: none;\n\t\t-moz-user-select: none;\n\t\topacity: .7;\n\t\tcursor: pointer;\n\t\tpadding-left: 0;\n\t\tpadding-right: 0;\n\t\tpadding-top: 0;\n\t\tpadding-bottom: 0;\n\t\tborder: 2px solid #eee;\n\t\tbackground-size: 70% 70%;\n\t\ttransition: all 250ms;\n\t\tfont-size: 13px;\n\t}\n\t.infobar:hover {\n\t\topacity: 1;\n\t}\n\t.infobar-open {\n\t\topacity: 1;\n\t\tbackground-color: #f9f9f9;\n\t\tcursor: auto;\n\t\tcolor: #2d2d2d;\n\t\tpadding-top: 2px;\n\t\tpadding-bottom: 2px;\n\t\tborder: 2px solid #878787;\n\t\tbackground-image: none;\n\t\tborder-radius: 8px;\n\t\tuser-select: initial;\n\t\t-moz-user-select: initial;\n\t}\n\t.infobar-close-button {\n\t\tdisplay: none;\n\t\topacity: .7;\n\t\tpadding-top: 4px;\n\t\tpadding-left: 8px;\n\t\tpadding-right: 8px;\n\t\tcursor: pointer;\n\t\ttransition: opacity 250ms;\n\t\theight: 16px;\n\t}\n\t.infobar-close-button:hover {\n\t\topacity: 1;\n\t}\n\t.infobar-content {\n\t\tdisplay: none;\n\t\tfont-family: Arial;\n\t\tfont-size: 14px;\n\t\tline-height: 22px;\n\t\tword-break: break-word;\n\t\twhite-space: pre-wrap;\n\t\tposition: relative;\n\t\ttop: 1px;\n\t\ttext-align: left;\n\t}\n\t.infobar-link {\n\t\tdisplay: none;\n\t\tpadding-left: 8px;\n\t\tpadding-right: 8px;\n\t\tline-height: 11px;\n\t\tcursor: pointer;\n\t\tuser-select: none;\n\t\toutline: 0;\n\t}\n\t.infobar-link-icon {\n\t\tpadding-top: 4px;\n\t\tpadding-left: 2px;\n\t\tcursor: pointer;\n\t\topacity: .7;\n\t\ttransition: opacity 250ms;\n\t\theight: 16px;\n\t}\n\t.infobar-link-icon:hover {\n\t\topacity: 1;\n\t}\n\t.infobar-open .infobar-close-button, .infobar-open .infobar-content, .infobar-open .infobar-link {\n\t\tdisplay: inline-block;\n\t}";let a=!0;const c=t.browser;async function s(){const t=document.evaluate("//comment()",document,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null);let s=t&&t.singleNodeValue;if(s&&((p=s).nodeType==Node.COMMENT_NODE&&p.textContent.includes(i))){const t=s.textContent.split("\n"),[,,i,p,...g]=t;if(i&&p){let t;t=c&&c.runtime&&c.runtime.sendMessage?await c.runtime.sendMessage({method:"tabs.getOptions",url:i}):{displayInfobar:!0},t.displayInfobar&&await async function(t,i,c){let s=document.querySelector(n);if(!s){if(t=t.split("url: ")[1],i=i.split("saved date: ")[1],c&&c.length>1){let t=c[0].split("info: ")[1].trim();for(let n=1;n<c.length-1;n++)t+="\n"+c[n].trim();c=t.trim()}else c=i;s=d(n,document.body),s.className=A;const p=await async function(t){if(t.attachShadow)return t.attachShadow({mode:"open"});{a=!1;const n=d("iframe",t);return n.style.setProperty("background-color","transparent","important"),n.style.setProperty("position","fixed","important"),n.style.setProperty("top",0,"important"),n.style.setProperty("right",0,"important"),n.style.setProperty("width","44px","important"),n.style.setProperty("height","48px","important"),n.style.setProperty("z-index",2147483647,"important"),new Promise((t=>{n.contentDocument.body.style.setProperty("margin",0),n.onload=()=>t(n.contentDocument.body)}))}}(s),g=document.createElement("style");g.textContent=r,p.appendChild(g);const u=document.createElement("div");u.classList.add("infobar"),p.appendChild(u);const h=document.createElement("img");h.classList.add("infobar-close-button"),u.appendChild(h),h.src=o,h.onclick=t=>{0===t.button&&s.remove()};const m=document.createElement("span");u.appendChild(m),m.classList.add("infobar-content"),m.textContent=c;const b=document.createElement("a");b.classList.add("infobar-link"),u.appendChild(b),b.target="_blank",b.rel="noopener noreferrer",b.title="Open source URL: "+t,b.href=t;const f=document.createElement("img");f.classList.add("infobar-link-icon"),b.appendChild(f),f.src=e,l(u),document.addEventListener("click",(t=>{if(0===t.button){let n=t.target;for(;n&&n!=s;)n=n.parentElement;n!=s&&l(u)}}))}}(i,p,g)}}var p}function l(t){if(t.classList.remove("infobar-open"),t.onclick=e=>{if(0===e.button)return function(t){a||document.querySelector(n).childNodes[0].contentWindow.getSelection().removeAllRanges();if(t.classList.add("infobar-open"),t.onclick=null,t.onmouseout=null,!a){const e=document.querySelector(n).childNodes[0];e.style.setProperty("width","100vw","important"),e.style.setProperty("height","100vh","important"),e.style.setProperty("width",t.getBoundingClientRect().width+33+"px","important"),e.style.setProperty("height",t.getBoundingClientRect().height+21+"px","important")}}(t),!1},!a){const t=document.querySelector(n).childNodes[0];t.style.setProperty("width","44px","important"),t.style.setProperty("height","48px","important")}}function d(t,n){const e=document.createElement(t);return n.appendChild(e),Array.from(getComputedStyle(e)).forEach((t=>e.style.setProperty(t,"initial","important"))),e}t.window==t.top&&("loading"==document.readyState?document.addEventListener("DOMContentLoaded",s,!1):s())})("object"==typeof globalThis?globalThis:window)}();
</script>
